<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Indeksid</title>
    <script type="text/javascript" src="jquery-2.1.0.min.js"></script>
	<link rel="stylesheet" href="http://openlayers.org/en/v3.2.1/css/ol.css" type="text/css">
    <script src="http://openlayers.org/en/v3.2.1/build/ol.js" type="text/javascript"></script>
    <script type="text/javascript" src="features.js"></script>
    <script type="text/javascript" src="proj4.js"></script>

    <style>
        html, body, #map {
            height: 100vh;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="map">
</div>

<script>
    proj4.defs("EPSG:3301", "+proj=lcc +lat_1=59.33333333333334 +lat_2=58 +lat_0=57.51755393055556 +lon_0=24 +x_0=500000 +y_0=6375000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");
    var projection = ol.proj.get('EPSG:3301');
	var map = new ol.Map({
        target: document.getElementById('map'),
        view: new ol.View({
            center: [532527.7637350822, 6575706.066542081],
            resolutions: [500.0, 250.0, 125.0, 62.5, 31.25, 15.625, 7.8125, 3.90625, 1.953125, 0.9765625, 0.48828125],
            projection: projection
        })
    });
    map.getView().setZoom(4);    
	var maakond = new ol.layer.Vector({
        title: 'index',
        source: new ol.source.GeoJSON({
            object: featurecollection
        }),
		style: function (feature) {
        var i = feature.getProperties().export_ky_;
        return [new ol.style.Style({
		fill: new ol.style.Fill({
            color: '#'+Math.floor(Math.random()*16777215).toString(16),
			weight: 1
			})
			 })];
    }
    });
	
  map.addLayer(maakond);

var featureOverlay = new ol.FeatureOverlay({
  map: map,
  style: new ol.style.Style({
    stroke: new ol.style.Stroke({
      color: '#319FD3',
      width: 1
    }),
    fill: new ol.style.Fill({
      color: 'rgba(142, 213, 237, 0.9)'
    })
  })
});
var highlight;
var displayFeatureInfo = function(pixel) {

  var feature = map.forEachFeatureAtPixel(pixel, function(feature, layer) {
    return feature;
  });

  if (feature !== highlight) {
    if (highlight) {
      featureOverlay.removeFeature(highlight);
    }
    if (feature) {
      featureOverlay.addFeature(feature);
    }
    highlight = feature;
  }

};
  map.on('pointermove', function(evt) {
  if (evt.dragging) {
    return;
  }
  var pixel = map.getEventPixel(evt.originalEvent);
  displayFeatureInfo(pixel);
});


map.on('click', function(evt) {
    var feature = map.forEachFeatureAtPixel(evt.pixel,
        function(feature, layer) {
          return feature;
        });
	alert(feature.getProperties().index)
	  
});


</script>
</body>
</html>